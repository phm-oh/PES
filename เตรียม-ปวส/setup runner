‡∏™‡∏£‡∏∏‡∏õ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£ Register GitLab Runner (VM1) ‡∏â‡∏ö‡∏±‡∏ö‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå (‡πÑ‡∏°‡πà‡∏≠‡∏≠‡∏Å‡πÄ‡∏ô‡πá‡∏ï)
‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢: ‡πÅ‡∏Å‡πâ‡∏õ‡∏±‡∏ç‡∏´‡∏≤ Pending ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô gitlab-runner ‡πÉ‡∏´‡πâ "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÉ‡∏à" Certificate ‡∏õ‡∏•‡∏≠‡∏° (Self-Signed) ‡∏Ç‡∏≠‡∏á caddy

üìú ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 1: "‡∏Ç‡πÇ‡∏°‡∏¢" Certificate ‡∏ï‡πâ‡∏ô‡∏â‡∏ö‡∏±‡∏ö‡∏à‡∏≤‡∏Å Caddy
‡πÑ‡∏õ‡∏ó‡∏µ‡πà Portainer (VM1) > Containers.

‡∏´‡∏≤ Container ‡∏ä‡∏∑‡πà‡∏≠ caddy (‡πÉ‡∏ô gitlab-stack).

‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô >_ Console.

(‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç!) ‡∏ó‡∏µ‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ Exec into container ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Command ‡∏à‡∏≤‡∏Å bash ‡πÄ‡∏õ‡πá‡∏ô sh ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Connect.

‡πÉ‡∏ô Console ‡∏Ç‡∏≠‡∏á caddy (/ #) ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠ "‡πÅ‡∏™‡∏î‡∏á" Certificate:

Bash

cat /data/caddy/pki/authorities/local/root.crt
"‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å" (Copy) ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• (‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ï‡πà -----BEGIN CERTIFICATE----- ‡∏à‡∏ô‡∏ñ‡∏∂‡∏á -----END CERTIFICATE-----).

üîë ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 2: "‡∏ß‡∏≤‡∏á" Certificate ‡∏•‡∏á‡πÉ‡∏ô Runner
‡πÑ‡∏õ‡∏ó‡∏µ‡πà Portainer (VM1) > Containers.

‡∏´‡∏≤ Container ‡∏ä‡∏∑‡πà‡∏≠ gitlab-runner (‡πÉ‡∏ô gitlab-runner).

‡∏Ñ‡∏•‡∏¥‡∏Å‡∏ó‡∏µ‡πà‡πÑ‡∏≠‡∏Ñ‡∏≠‡∏ô >_ Console (‡∏ï‡∏±‡∏ß‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ bash ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢).

‡πÉ‡∏ô Console ‡∏Ç‡∏≠‡∏á gitlab-runner (ab14...:/#) ‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ô‡∏µ‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠ "‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏°‡πà" ‡∏î‡πâ‡∏ß‡∏¢ vi:

Bash

vi /tmp/caddy_root.crt
‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° i (‡∏ï‡∏±‡∏ß‡πÑ‡∏≠) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤ "Insert Mode".

"‡∏ß‡∏≤‡∏á" (Paste) Certificate ‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏°‡∏≤‡∏à‡∏≤‡∏Å caddy.

‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° Esc (Escape).

‡∏û‡∏¥‡∏°‡∏û‡πå :wq ‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡∏î Enter (‡πÄ‡∏û‡∏∑‡πà‡∏≠ Save ‡πÅ‡∏•‡∏∞ Quit).

‚ÄºÔ∏è ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 3: ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á Register (‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏¢‡∏∑‡πà‡∏ô‡∏ö‡∏±‡∏ï‡∏£)
‡πÉ‡∏ô Console ‡∏Ç‡∏≠‡∏á gitlab-runner (ab14...:/#) ‡πÉ‡∏´‡πâ‡∏£‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á register (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô https://) ‡πÇ‡∏î‡∏¢‡πÄ‡∏û‡∏¥‡πà‡∏° Flag --tls-ca-file ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ä‡∏µ‡πâ‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏£‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á:

Bash

gitlab-runner register --url https://gitlab.vecskill.ovec --token glrt-B-059MhXQ0pkSkwzgSuXHG86MQp0OjEKdToxCw.01.121atgtd6 --tls-ca-file="/tmp/caddy_root.crt"
‚úÖ ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏ó‡∏µ‡πà 4: ‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
Enter the GitLab instance URL...:

‡∏Å‡∏î Enter (‡∏°‡∏±‡∏ô‡∏à‡∏∞‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ https://gitlab.vecskill.ovec:`])

(‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° Verifying runner... is valid ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏ß‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!)

Enter a name for the runner...:

‡∏û‡∏¥‡∏°‡∏û‡πå: VM1 Docker Runner

‡∏Å‡∏î Enter

Enter an executor: ...

(‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å!) ‡∏û‡∏¥‡∏°‡∏û‡πå: docker

‡∏Å‡∏î Enter

Enter the default Docker image:

‡∏û‡∏¥‡∏°‡∏û‡πå: alpine:latest

‡∏Å‡∏î Enter
